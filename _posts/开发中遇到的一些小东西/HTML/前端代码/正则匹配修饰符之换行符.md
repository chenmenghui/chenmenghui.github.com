---
title: 正则匹配修饰符
date: 2019-12-19 01:26:15
categories: js
tags: 
- 实用代码片段
---

被win下的crlf换行符坑了一把
```php
// crlf模式
$str = <<<str
aaaa |
|
kkk |
str;

$pattern = "/\|\r$/m";
$replace = "i";
$res = preg_replace($pattern,$replace, $str);
echo ($res);
```
result
```
aaaa i
i
kkk |
```

终于写出一个把命令行查出结果转化成excel的小脚本了
```php
$data = file_get_contents('data.txt');
$pattern = [
    "/(\r|\n|\r\n){2,}/",              // 删除多余空行
    "/\+(-+\+)+(\r|\n|\r\n)/",         // 删除「+-----+----+」
    "/^\| */m",                     // 删除行首「|」
    "/ *\|(\r|\n|\r\n)/",              // 删除行尾「|」              // 为什么只有在「lf」模式下才能用「/ *\|$/」
    "/ *\| */",                     // 把行内「|」替换成「tab」
];
$replace = [
    "$1",
    "",
    "",
    "$1",
    "\t",
];
$res = preg_replace($pattern, $replace, $data);
file_put_contents('res.xls', $res);
```

